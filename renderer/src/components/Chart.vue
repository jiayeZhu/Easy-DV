<template>
  <div>
    <!-- <Button @click='show("bar")'>切换至柱状/折线组合图</Button>
    <Button @click='show("radar")'>切换至雷达图</Button>
    <Button @click='show("pie")'>切换至饼图</Button> -->
    <h2 style="display:inline; margin-right:10px" >展示图表</h2>
    <Select v-model="optType" placeholder="展示图表" style="width:20%">
      <Option v-for="type in chartType" :value="type.value" :key="type">{{ type.label }}</Option>
    </Select>
    <Button style="margin:0 10px" @click="save">保存数据</Button>
    <IEcharts :option="currentOpt" :loading="loading" :style="style" :notMerge='notMerge' @ready="onReady" @click="onClick"></IEcharts>
    <!-- <button @click="doRandom">Random</button> -->
  </div>
</template>

<script>

import IEcharts from 'vue-echarts-v3';
const IPCHandler = require('../IPCHandler');

export default {
  components:{
    IEcharts
  },
  data () {
    return {
      chartType:[
      {
        value:'bar',
        label:'柱状/折线组合图'
      },
      {
        value:'radar',
        label:'雷达图'
      },
      {
        value:'pie',
        label:'饼图'
      }
      ],
      optType:'bar',
      notMerge:true,
      loading: false,
      bar: {
        tooltip : {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow',
                label: {
                    show: true
                }
            }
        },
        toolbox: {
            show : true,
            feature : {
                magicType: {show: true, type: ['line', 'bar']},
                restore : {show: true},
                saveAsImage : {show: true}
            }
        },
        legend: {
            data:['一氧化碳', '二氧化氮', 'pm10','pm2.5','臭氧'],
        },

        xAxis: [
            {
                type : 'category',
                data : ["2014-07-15","2014-07-14","2014-07-13","2014-07-12","2014-07-11","2014-07-10","2014-07-09","2014-07-08","2014-07-07","2014-07-06","2014-07-05","2014-07-04","2014-07-03","2014-07-02","2014-07-01","2014-06-30","2014-06-29","2014-06-28","2014-06-27","2014-06-26","2014-06-25","2014-06-24","2014-06-23","2014-06-22","2014-06-21","2014-06-20","2014-06-19","2014-06-18","2014-06-17","2014-06-16","2014-06-15","2014-06-14","2014-06-13","2014-06-12","2014-06-11","2014-06-10","2014-06-09","2014-06-08","2014-06-07","2014-06-06","2014-06-05","2014-06-04","2014-06-03","2014-06-02","2014-06-01","2014-05-31"].reverse()
            }
        ],
        yAxis: [
            {
                type : 'value',
            }
        ],
        dataZoom: [
            {
                show: true,
                start: 90,
                end: 100
            },
            // {
            //     type: 'inside',
            //     start: 24,
            //     end: 100
            // },
            {
                show: true,
                yAxisIndex: 0,
                filterMode: 'empty',
                width: 30,
                height: '80%',
                // left: '90%'
            }
        ],
        series : [
          {
            name: '一氧化碳',
            type: 'bar',
            smooth: true,
            data: [0.8802,0.813919028340081,0.8281703056768559,0.9025230125523013,1.056545871559633,1.101379746835443,0.6051917808219178,0.497528384279476,0.6626212765957448,0.7000669456066946,0.4975588235294117,0.6009666666666666,0.9954517543859649,0.8163580786026201,0.5380851063829787,0.7866384976525822,0.8835614035087719,1.060408256880734,0.6780218340611354,0.7122318181818182,0.6247224489795918,0.6185586206896552,0.5787769784172662,0.4956398305084746,0.5799906103286385,0.6667874015748032,0.5258069306930693,0.542380487804878,0.7970711111111112,0.5006133333333334,0.5927965367965369,0.8315091743119266,0.8226652360515022,0.6528851674641148,0.45973362445414845,0.4388808510638298,0.4289908675799087,0.4212461538461538,0.5761026785714286,0.5695470085470086,0.6031385281385281,0.7505927419354839,0.7042606837606837,0.7631201923076923,0.467136546184739,0.46456962025316456].reverse()
          },
          {
            name: '二氧化氮',
            type: 'bar',
            smooth: true,
            data: [34.5,30.068825910931174,30.349344978165938,42.35146443514645,49.11009174311926,44.426160337552744,18.64840182648402,22.32751091703057,32.03404255319149,26.690376569037657,22.666666666666668,29.679166666666667,33.3640350877193,32.951965065502186,24.846808510638297,35.840375586854464,46.574561403508774,53.211009174311926,33.55458515283843,39.35909090909091,29.485714285714284,26.041379310344826,28.388489208633093,26.097457627118644,31.093896713615024,38.56299212598425,21.485148514851485,28.165853658536584,36.035555555555554,18.6,36.476190476190474,51.357798165137616,45.1931330472103,33.69377990430622,21.777292576419214,19.208510638297874,16.78082191780822,20.317948717948717,28.004464285714285,33.837606837606835,31.917748917748916,32.49596774193548,29.055555555555557,23.26923076923077,15.775100401606426,16.924050632911392].reverse()
          },
          {
            name:'pm10',
            type:'bar',
            smooth: true,
            data:[7.6,26.635627530364374,20.170305676855897,41.97071129707113,93.6697247706422,115.33755274261604,36.87214611872146,29.497816593886462,39.255319148936174,38.72803347280335,39.254901960784316,29.8625,41.14473684210526,32.17903930131004,29.65531914893617,45.81220657276995,67.8859649122807,76.70183486238533,22.19650655021834,13.918181818181818,18.836734693877553,47.144827586206894,29.820143884892087,25.864406779661017,8.370892018779342,33.30708661417323,40.975247524752476,31.46829268292683,43.83111111111111,30.204444444444444,74.6103896103896,131.89449541284404,108.27038626609442,70.77511961722487,41.06550218340611,33.35744680851064,34.55251141552512,32.13846153846154,54.19642857142857,49.94871794871795,44.45887445887446,60.53225806451613,42.18803418803419,23.14903846153846,24.783132530120483,79.29113924050633].reverse()
          },
          {
            name:'pm2.5',
            type:'bar',
            smooth: true,
            data:[32.9,73.25910931174089,40.25764192139738,77.84518828451883,125.77981651376147,88.45991561181435,22.835616438356166,25.397379912663755,43.212765957446805,47.73640167364017,27.66176470588235,43.516666666666666,74.96491228070175,45.39737991266376,36.97021276595745,65.15962441314554,99.08333333333333,89.54128440366972,21.096069868995635,16.613636363636363,23.10612244897959,45.793103448275865,36.10071942446043,21.444915254237287,26.657276995305164,32.91732283464567,35.49009900990099,22.809756097560975,36.44888888888889,21.484444444444446,51.06926406926407,93.88990825688073,83.6137339055794,54.41626794258373,27.746724890829693,23.727659574468085,27.200913242009133,37.50769230769231,58.33482142857143,50.243589743589745,39.8008658008658,58.403225806451616,41.136752136752136,46.30769230769231,21.365461847389557,39].reverse()
          },
          {
            name:'臭氧',
            type:'bar',
            smooth: true,
            data:[111.32911392405063,78.5863453815261,70.71153846153847,74.97863247863248,69.01612903225806,72.24242424242425,76.32051282051282,89.80357142857143,65.26666666666667,66.19634703196347,48.83404255319149,60.903930131004365,74.66985645933015,115.13733905579399,129.3119266055046,70.0952380952381,67.66666666666667,59.693333333333335,87.6390243902439,92.53960396039604,48.011811023622045,50.04694835680751,70.97881355932203,42.69064748201439,107.46206896551725,68.13061224489796,56.43636363636364,52.90829694323144,56.58715596330275,92.12719298245614,68.08920187793427,52.94042553191489,38.65065502183406,59.71052631578947,72.38333333333334,48.46078431372549,60.88284518828452,52.92340425531915,59.58951965065502,34.25570776255708,84.0210970464135,88.3302752293578,74.0376569037657,66.5065502183406,94.2914979757085,87].reverse()
          }
        ]
      },
      radarOpt:{
        baseOption:{
          timeline:{
            axisType: 'category',
            autoPlay: true,
            playInterval: 1000,
            data:["2014-05-31","2014-06-01","2014-06-02","2014-06-03","2014-06-04","2014-06-05","2014-06-06","2014-06-07","2014-06-08","2014-06-09","2014-06-10","2014-06-11","2014-06-12","2014-06-13","2014-06-14","2014-06-15","2014-06-16","2014-06-17","2014-06-18","2014-06-19","2014-06-20","2014-06-21","2014-06-22","2014-06-23","2014-06-24","2014-06-25","2014-06-26","2014-06-27","2014-06-28","2014-06-29","2014-06-30","2014-07-01","2014-07-02","2014-07-03","2014-07-04","2014-07-05","2014-07-06","2014-07-07","2014-07-08","2014-07-09","2014-07-10","2014-07-11","2014-07-12","2014-07-13","2014-07-14","2014-07-15"],
            label:{
              show:false
            }
          },
          tooltip:{},
          radar:{
            indicator:[
              {name:'O3',max:150},
              {name:'CO',max:150},
              {name:'NO2',max:150},
              {name:'pm10',max:150},
              {name:'pm2.5',max:150},
            ],
            axisLine: {
              lineStyle: {
                color: 'rgba(0, 0, 0, 0.35)'
              }
            },
          },
          
        },
        options:[{"array":[111.32911392405063,0.46456962025316456,16.924050632911392,79.29113924050633,39]},{"array":[78.5863453815261,0.467136546184739,15.775100401606426,24.783132530120483,21.365461847389557]},{"array":[70.71153846153847,0.7631201923076923,23.26923076923077,23.14903846153846,46.30769230769231]},{"array":[74.97863247863248,0.7042606837606837,29.055555555555557,42.18803418803419,41.136752136752136]},{"array":[69.01612903225806,0.7505927419354839,32.49596774193548,60.53225806451613,58.403225806451616]},{"array":[72.24242424242425,0.6031385281385281,31.917748917748916,44.45887445887446,39.8008658008658]},{"array":[76.32051282051282,0.5695470085470086,33.837606837606835,49.94871794871795,50.243589743589745]},{"array":[89.80357142857143,0.5761026785714286,28.004464285714285,54.19642857142857,58.33482142857143]},{"array":[65.26666666666667,0.4212461538461538,20.317948717948717,32.13846153846154,37.50769230769231]},{"array":[66.19634703196347,0.4289908675799087,16.78082191780822,34.55251141552512,27.200913242009133]},{"array":[48.83404255319149,0.4388808510638298,19.208510638297874,33.35744680851064,23.727659574468085]},{"array":[60.903930131004365,0.45973362445414845,21.777292576419214,41.06550218340611,27.746724890829693]},{"array":[74.66985645933015,0.6528851674641148,33.69377990430622,70.77511961722487,54.41626794258373]},{"array":[115.13733905579399,0.8226652360515022,45.1931330472103,108.27038626609442,83.6137339055794]},{"array":[129.3119266055046,0.8315091743119266,51.357798165137616,131.89449541284404,93.88990825688073]},{"array":[70.0952380952381,0.5927965367965369,36.476190476190474,74.6103896103896,51.06926406926407]},{"array":[67.66666666666667,0.5006133333333334,18.6,30.204444444444444,21.484444444444446]},{"array":[59.693333333333335,0.7970711111111112,36.035555555555554,43.83111111111111,36.44888888888889]},{"array":[87.6390243902439,0.542380487804878,28.165853658536584,31.46829268292683,22.809756097560975]},{"array":[92.53960396039604,0.5258069306930693,21.485148514851485,40.975247524752476,35.49009900990099]},{"array":[48.011811023622045,0.6667874015748032,38.56299212598425,33.30708661417323,32.91732283464567]},{"array":[50.04694835680751,0.5799906103286385,31.093896713615024,8.370892018779342,26.657276995305164]},{"array":[70.97881355932203,0.4956398305084746,26.097457627118644,25.864406779661017,21.444915254237287]},{"array":[42.69064748201439,0.5787769784172662,28.388489208633093,29.820143884892087,36.10071942446043]},{"array":[107.46206896551725,0.6185586206896552,26.041379310344826,47.144827586206894,45.793103448275865]},{"array":[68.13061224489796,0.6247224489795918,29.485714285714284,18.836734693877553,23.10612244897959]},{"array":[56.43636363636364,0.7122318181818182,39.35909090909091,13.918181818181818,16.613636363636363]},{"array":[52.90829694323144,0.6780218340611354,33.55458515283843,22.19650655021834,21.096069868995635]},{"array":[56.58715596330275,1.060408256880734,53.211009174311926,76.70183486238533,89.54128440366972]},{"array":[92.12719298245614,0.8835614035087719,46.574561403508774,67.8859649122807,99.08333333333333]},{"array":[68.08920187793427,0.7866384976525822,35.840375586854464,45.81220657276995,65.15962441314554]},{"array":[52.94042553191489,0.5380851063829787,24.846808510638297,29.65531914893617,36.97021276595745]},{"array":[38.65065502183406,0.8163580786026201,32.951965065502186,32.17903930131004,45.39737991266376]},{"array":[59.71052631578947,0.9954517543859649,33.3640350877193,41.14473684210526,74.96491228070175]},{"array":[72.38333333333334,0.6009666666666666,29.679166666666667,29.8625,43.516666666666666]},{"array":[48.46078431372549,0.4975588235294117,22.666666666666668,39.254901960784316,27.66176470588235]},{"array":[60.88284518828452,0.7000669456066946,26.690376569037657,38.72803347280335,47.73640167364017]},{"array":[52.92340425531915,0.6626212765957448,32.03404255319149,39.255319148936174,43.212765957446805]},{"array":[59.58951965065502,0.497528384279476,22.32751091703057,29.497816593886462,25.397379912663755]},{"array":[34.25570776255708,0.6051917808219178,18.64840182648402,36.87214611872146,22.835616438356166]},{"array":[84.0210970464135,1.101379746835443,44.426160337552744,115.33755274261604,88.45991561181435]},{"array":[88.3302752293578,1.056545871559633,49.11009174311926,93.6697247706422,125.77981651376147]},{"array":[74.0376569037657,0.9025230125523013,42.35146443514645,41.97071129707113,77.84518828451883]},{"array":[66.5065502183406,0.8281703056768559,30.349344978165938,20.170305676855897,40.25764192139738]},{"array":[94.2914979757085,0.813919028340081,30.068825910931174,26.635627530364374,73.25910931174089]},{"array":[87,0.8802,34.5,7.6,32.9]}]
                .map(e=>{
                  return {
                    series:[{
                      type:'radar',
                      data:[e.array],
                      label:{
                        normal:{
                          show:true,
                          formatter:(parm)=>{
                            return parm.value.toFixed(2);
                          }
                        }
                      }
                    }]
                  }
                }),
      },
      pieOpt:{
        baseOption:{
          timeline:{
            axisType: 'category',
            autoPlay: true,
            playInterval: 1000,
            data:["2014-05-31","2014-06-01","2014-06-02","2014-06-03","2014-06-04","2014-06-05","2014-06-06","2014-06-07","2014-06-08","2014-06-09","2014-06-10","2014-06-11","2014-06-12","2014-06-13","2014-06-14","2014-06-15","2014-06-16","2014-06-17","2014-06-18","2014-06-19","2014-06-20","2014-06-21","2014-06-22","2014-06-23","2014-06-24","2014-06-25","2014-06-26","2014-06-27","2014-06-28","2014-06-29","2014-06-30","2014-07-01","2014-07-02","2014-07-03","2014-07-04","2014-07-05","2014-07-06","2014-07-07","2014-07-08","2014-07-09","2014-07-10","2014-07-11","2014-07-12","2014-07-13","2014-07-14","2014-07-15"],
            label:{
              show:false
            }
          },
          tooltip:{},
          legend:{
            data:['臭氧','一氧化碳','二氧化氮','pm10','pm2.5']
          },
          series:[{name:'air',type:'pie'}]
          
        },
        options:[{"array":[111.32911392405063,0.46456962025316456,16.924050632911392,79.29113924050633,39]},{"array":[78.5863453815261,0.467136546184739,15.775100401606426,24.783132530120483,21.365461847389557]},{"array":[70.71153846153847,0.7631201923076923,23.26923076923077,23.14903846153846,46.30769230769231]},{"array":[74.97863247863248,0.7042606837606837,29.055555555555557,42.18803418803419,41.136752136752136]},{"array":[69.01612903225806,0.7505927419354839,32.49596774193548,60.53225806451613,58.403225806451616]},{"array":[72.24242424242425,0.6031385281385281,31.917748917748916,44.45887445887446,39.8008658008658]},{"array":[76.32051282051282,0.5695470085470086,33.837606837606835,49.94871794871795,50.243589743589745]},{"array":[89.80357142857143,0.5761026785714286,28.004464285714285,54.19642857142857,58.33482142857143]},{"array":[65.26666666666667,0.4212461538461538,20.317948717948717,32.13846153846154,37.50769230769231]},{"array":[66.19634703196347,0.4289908675799087,16.78082191780822,34.55251141552512,27.200913242009133]},{"array":[48.83404255319149,0.4388808510638298,19.208510638297874,33.35744680851064,23.727659574468085]},{"array":[60.903930131004365,0.45973362445414845,21.777292576419214,41.06550218340611,27.746724890829693]},{"array":[74.66985645933015,0.6528851674641148,33.69377990430622,70.77511961722487,54.41626794258373]},{"array":[115.13733905579399,0.8226652360515022,45.1931330472103,108.27038626609442,83.6137339055794]},{"array":[129.3119266055046,0.8315091743119266,51.357798165137616,131.89449541284404,93.88990825688073]},{"array":[70.0952380952381,0.5927965367965369,36.476190476190474,74.6103896103896,51.06926406926407]},{"array":[67.66666666666667,0.5006133333333334,18.6,30.204444444444444,21.484444444444446]},{"array":[59.693333333333335,0.7970711111111112,36.035555555555554,43.83111111111111,36.44888888888889]},{"array":[87.6390243902439,0.542380487804878,28.165853658536584,31.46829268292683,22.809756097560975]},{"array":[92.53960396039604,0.5258069306930693,21.485148514851485,40.975247524752476,35.49009900990099]},{"array":[48.011811023622045,0.6667874015748032,38.56299212598425,33.30708661417323,32.91732283464567]},{"array":[50.04694835680751,0.5799906103286385,31.093896713615024,8.370892018779342,26.657276995305164]},{"array":[70.97881355932203,0.4956398305084746,26.097457627118644,25.864406779661017,21.444915254237287]},{"array":[42.69064748201439,0.5787769784172662,28.388489208633093,29.820143884892087,36.10071942446043]},{"array":[107.46206896551725,0.6185586206896552,26.041379310344826,47.144827586206894,45.793103448275865]},{"array":[68.13061224489796,0.6247224489795918,29.485714285714284,18.836734693877553,23.10612244897959]},{"array":[56.43636363636364,0.7122318181818182,39.35909090909091,13.918181818181818,16.613636363636363]},{"array":[52.90829694323144,0.6780218340611354,33.55458515283843,22.19650655021834,21.096069868995635]},{"array":[56.58715596330275,1.060408256880734,53.211009174311926,76.70183486238533,89.54128440366972]},{"array":[92.12719298245614,0.8835614035087719,46.574561403508774,67.8859649122807,99.08333333333333]},{"array":[68.08920187793427,0.7866384976525822,35.840375586854464,45.81220657276995,65.15962441314554]},{"array":[52.94042553191489,0.5380851063829787,24.846808510638297,29.65531914893617,36.97021276595745]},{"array":[38.65065502183406,0.8163580786026201,32.951965065502186,32.17903930131004,45.39737991266376]},{"array":[59.71052631578947,0.9954517543859649,33.3640350877193,41.14473684210526,74.96491228070175]},{"array":[72.38333333333334,0.6009666666666666,29.679166666666667,29.8625,43.516666666666666]},{"array":[48.46078431372549,0.4975588235294117,22.666666666666668,39.254901960784316,27.66176470588235]},{"array":[60.88284518828452,0.7000669456066946,26.690376569037657,38.72803347280335,47.73640167364017]},{"array":[52.92340425531915,0.6626212765957448,32.03404255319149,39.255319148936174,43.212765957446805]},{"array":[59.58951965065502,0.497528384279476,22.32751091703057,29.497816593886462,25.397379912663755]},{"array":[34.25570776255708,0.6051917808219178,18.64840182648402,36.87214611872146,22.835616438356166]},{"array":[84.0210970464135,1.101379746835443,44.426160337552744,115.33755274261604,88.45991561181435]},{"array":[88.3302752293578,1.056545871559633,49.11009174311926,93.6697247706422,125.77981651376147]},{"array":[74.0376569037657,0.9025230125523013,42.35146443514645,41.97071129707113,77.84518828451883]},{"array":[66.5065502183406,0.8281703056768559,30.349344978165938,20.170305676855897,40.25764192139738]},{"array":[94.2914979757085,0.813919028340081,30.068825910931174,26.635627530364374,73.25910931174089]},{"array":[87,0.8802,34.5,7.6,32.9]}]
                .map(e=>{
                  return {
                    series:[{
                      type:'pie',
                      // name:'空气污染物',
                      data:e.array.map((_e,idx)=>{
                        // console.log(_e);
                        // console.log(e);
                        switch(idx){
                          case 0:

                            return {value:_e,name:'臭氧'}
                            break;
                          case 1:
                            return {value:_e,name:'一氧化碳'}
                            break;
                          case 2:
                            return {value:_e,name:'二氧化氮'}
                            break;
                          case 3:
                            return {value:_e,name:'pm10'}
                            break;
                          case 4:
                            return {value:_e,name:'pm2.5'}
                            break;

                        }}),
                      // itemStyle:{
                      //   emphasis:{
                      //     shadowBlur: 10,
                      //     shadowOffsetX: 0,
                      //     shadowColor: 'rgba(0,0,0,0.5)'
                      //   }
                      // }
                    }]
                  }
                }),
      },
      style: {
        width:'100%',
        height:'600px'
      }
    }
  },
  methods:{
    doRandom() {
      const that = this;
      let data = [];
      for (let i = 0, min = 5, max = 99; i < 6; i++) {
        data.push(Math.floor(Math.random() * (max + 1 - min) + min));
      }
      that.bar.series[0].data = data;
    },
    onReady(instance) {
      console.log(instance);
    },
    onClick(event, instance, echarts) {
      console.log(arguments);
    },
    show(type){
      this.optType = type;
    },
    save(){
      let data = JSON.stringify({bar:this.bar,radarOpt:this.radarOpt,pieOpt:this.pieOpt});
      IPCHandler('save',{data});
    }
  },
  computed:{
    currentOpt () {
      let type = this.optType;
      switch(type){
        case 'bar':
          return this.bar;
          break;
        case 'radar':
          return this.radarOpt;
          break;
        case 'pie':
          return this.pieOpt;
          break;
      }
    },
  }
}
</script>

<style scoped>

</style>
